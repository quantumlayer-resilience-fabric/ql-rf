/**
 * Mock data for E2E tests
 * Provides consistent test data for API responses and fixtures
 */

export const mockAssets = [
  {
    id: "asset-1",
    name: "web-server-prod-01",
    platform: "aws",
    site_id: "site-1",
    status: "healthy",
    image_id: "image-1",
    created_at: "2024-01-01T00:00:00Z",
    updated_at: "2024-01-15T10:30:00Z",
  },
  {
    id: "asset-2",
    name: "db-server-prod-01",
    platform: "azure",
    site_id: "site-2",
    status: "drift",
    image_id: "image-2",
    created_at: "2024-01-05T00:00:00Z",
    updated_at: "2024-01-14T15:45:00Z",
  },
  {
    id: "asset-3",
    name: "app-server-prod-01",
    platform: "gcp",
    site_id: "site-3",
    status: "healthy",
    image_id: "image-1",
    created_at: "2024-01-10T00:00:00Z",
    updated_at: "2024-01-16T08:20:00Z",
  },
];

export const mockImages = [
  {
    id: "image-1",
    family_id: "family-1",
    family_name: "ql-base-linux",
    version: "1.6.4",
    platform: "aws",
    status: "active",
    is_golden: true,
    parent_id: "image-0",
    created_at: "2024-01-01T00:00:00Z",
    promoted_at: "2024-01-02T00:00:00Z",
    vulnerability_count: 0,
    drift_score: 100,
  },
  {
    id: "image-2",
    family_id: "family-2",
    family_name: "ql-windows-server",
    version: "2.1.0",
    platform: "azure",
    status: "active",
    is_golden: true,
    parent_id: null,
    created_at: "2023-12-15T00:00:00Z",
    promoted_at: "2023-12-20T00:00:00Z",
    vulnerability_count: 3,
    drift_score: 85,
  },
  {
    id: "image-3",
    family_id: "family-1",
    family_name: "ql-base-linux",
    version: "1.6.5-rc1",
    platform: "aws",
    status: "candidate",
    is_golden: false,
    parent_id: "image-1",
    created_at: "2024-01-15T00:00:00Z",
    promoted_at: null,
    vulnerability_count: 0,
    drift_score: 100,
  },
];

export const mockLineage = {
  image_id: "image-1",
  family_id: "family-1",
  family_name: "ql-base-linux",
  nodes: [
    {
      id: "image-0",
      version: "1.6.3",
      created_at: "2023-12-01T00:00:00Z",
      is_golden: true,
      children: ["image-1"],
    },
    {
      id: "image-1",
      version: "1.6.4",
      created_at: "2024-01-01T00:00:00Z",
      is_golden: true,
      parent: "image-0",
      children: ["image-3"],
    },
    {
      id: "image-3",
      version: "1.6.5-rc1",
      created_at: "2024-01-15T00:00:00Z",
      is_golden: false,
      parent: "image-1",
    },
  ],
};

export const mockDriftReport = {
  overall_drift_score: 87.5,
  total_assets: 6547,
  drifted_assets: 342,
  in_compliance: 6205,
  last_scan_at: "2024-01-16T12:00:00Z",
  drift_by_platform: [
    { platform: "aws", drift_score: 92.3, drifted: 85, total: 2431 },
    { platform: "azure", drift_score: 84.1, drifted: 178, total: 2419 },
    { platform: "gcp", drift_score: 88.7, drifted: 42, total: 654 },
    { platform: "vsphere", drift_score: 79.2, drifted: 37, total: 753 },
  ],
  drift_by_site: [
    {
      site_id: "site-1",
      site_name: "us-east-prod",
      platform: "aws",
      drift_score: 94.5,
      drifted: 32,
      total: 1243,
    },
    {
      site_id: "site-2",
      site_name: "westeurope-prod",
      platform: "azure",
      drift_score: 81.3,
      drifted: 89,
      total: 1419,
    },
    {
      site_id: "site-3",
      site_name: "us-central-prod",
      platform: "gcp",
      drift_score: 88.7,
      drifted: 42,
      total: 654,
    },
  ],
  top_drift_packages: [
    { package: "openssl", expected_version: "3.0.2", drifted_assets: 89 },
    { package: "systemd", expected_version: "249.11", drifted_assets: 67 },
    { package: "curl", expected_version: "7.81.0", drifted_assets: 45 },
  ],
};

export const mockComplianceSummary = {
  overallScore: 89.5,
  cisCompliance: 92.3,
  slsaLevel: 3,
  sigstoreVerified: 87.4,
  lastAuditAt: "2024-01-16T08:00:00Z",
  frameworks: [
    {
      id: "cis",
      name: "CIS Benchmarks",
      description: "Center for Internet Security best practices",
      score: 92.3,
      status: "passing",
      passingControls: 142,
      totalControls: 154,
    },
    {
      id: "slsa",
      name: "SLSA",
      description: "Supply-chain Levels for Software Artifacts",
      level: 3,
      score: 87.5,
      status: "passing",
      passingControls: 28,
      totalControls: 32,
    },
    {
      id: "soc2",
      name: "SOC 2",
      description: "Service Organization Control 2",
      score: 85.7,
      status: "warning",
      passingControls: 67,
      totalControls: 78,
    },
  ],
  failingControls: [
    {
      id: "CIS-4.1.2",
      title: "Ensure auditing for processes that start prior to auditd is enabled",
      framework: "CIS",
      severity: "high",
      affectedAssets: 23,
      recommendation:
        "Enable audit=1 kernel parameter in bootloader configuration",
    },
    {
      id: "SOC2-CC6.1",
      title: "Logical and Physical Access Controls",
      framework: "SOC 2",
      severity: "medium",
      affectedAssets: 15,
      recommendation: "Implement multi-factor authentication for all privileged access",
    },
    {
      id: "SLSA-1.2",
      title: "Build Service Configuration",
      framework: "SLSA",
      severity: "high",
      affectedAssets: 8,
      recommendation: "Configure build service to generate provenance attestations",
    },
  ],
  imageCompliance: [
    {
      familyId: "family-1",
      familyName: "ql-base-linux",
      version: "1.6.4",
      cis: true,
      slsaLevel: 3,
      cosignSigned: true,
      lastScanAt: "2024-01-16T08:00:00Z",
      issueCount: 0,
    },
    {
      familyId: "family-2",
      familyName: "ql-windows-server",
      version: "2.1.0",
      cis: true,
      slsaLevel: 2,
      cosignSigned: false,
      lastScanAt: "2024-01-15T10:00:00Z",
      issueCount: 3,
    },
  ],
};

export const mockResilienceSummary = {
  drReadiness: 88.5,
  rpoCompliance: 94.2,
  rtoCompliance: 91.8,
  totalPairs: 4,
  healthyPairs: 3,
  lastFailoverTest: "2024-01-10T14:00:00Z",
  drPairs: [
    {
      id: "pair-1",
      status: "healthy",
      replicationStatus: "in-sync",
      primarySite: {
        id: "site-1",
        name: "us-east-prod",
        platform: "aws",
        region: "us-east-1",
        assetCount: 1243,
        rto: "1h",
        rpo: "15m",
      },
      drSite: {
        id: "site-4",
        name: "us-west-dr",
        platform: "aws",
        region: "us-west-2",
        assetCount: 1243,
        lastSyncAt: "2024-01-16T12:00:00Z",
      },
      lastFailoverTest: "2024-01-10T14:00:00Z",
    },
    {
      id: "pair-2",
      status: "healthy",
      replicationStatus: "in-sync",
      primarySite: {
        id: "site-2",
        name: "westeurope-prod",
        platform: "azure",
        region: "West Europe",
        assetCount: 1419,
        rto: "2h",
        rpo: "30m",
      },
      drSite: {
        id: "site-5",
        name: "northeurope-dr",
        platform: "azure",
        region: "North Europe",
        assetCount: 1419,
        lastSyncAt: "2024-01-16T11:55:00Z",
      },
      lastFailoverTest: "2024-01-08T10:00:00Z",
    },
    {
      id: "pair-3",
      status: "warning",
      replicationStatus: "lagging",
      primarySite: {
        id: "site-3",
        name: "us-central-prod",
        platform: "gcp",
        region: "us-central1",
        assetCount: 654,
        rto: "1h",
        rpo: "15m",
      },
      drSite: {
        id: "site-6",
        name: "us-east-dr",
        platform: "gcp",
        region: "us-east1",
        assetCount: 654,
        lastSyncAt: "2024-01-16T10:30:00Z",
      },
      lastFailoverTest: "2024-01-05T16:00:00Z",
    },
  ],
  unpairedSites: [
    {
      id: "site-7",
      name: "Singapore DC",
      platform: "vsphere",
      region: "ap-southeast-1",
      assetCount: 753,
      status: "healthy",
    },
  ],
};

export const mockAITasks = [
  {
    id: "task-1",
    user_intent: "Check drift status on web servers in us-east region",
    status: "completed",
    created_at: "2024-01-16T10:00:00Z",
    completed_at: "2024-01-16T10:02:35Z",
    agent_type: "drift",
    result_summary: "Found 5 drifted packages across 12 web servers. Generated remediation plan.",
  },
  {
    id: "task-2",
    user_intent: "Analyze compliance gaps and generate remediation recommendations",
    status: "pending_approval",
    created_at: "2024-01-16T11:00:00Z",
    completed_at: null,
    agent_type: "compliance",
    result_summary: null,
    plan: {
      steps: [
        "Audit all CIS controls",
        "Identify failing controls with high severity",
        "Generate remediation playbooks",
        "Schedule automated fixes",
      ],
      estimated_duration: "15 minutes",
      affected_resources: ["All production assets"],
    },
  },
  {
    id: "task-3",
    user_intent: "Optimize DR configuration for AWS pairs",
    status: "running",
    created_at: "2024-01-16T12:00:00Z",
    completed_at: null,
    agent_type: "dr",
    result_summary: null,
  },
];

export const mockAIAgents = [
  {
    id: "drift-agent",
    name: "Drift Detective",
    description: "Identifies configuration drift and package mismatches",
    status: "active",
    tasks_completed: 234,
    success_rate: 98.5,
  },
  {
    id: "patch-agent",
    name: "Patch Orchestrator",
    description: "Manages OS and package patching across platforms",
    status: "active",
    tasks_completed: 567,
    success_rate: 97.2,
  },
  {
    id: "compliance-agent",
    name: "Compliance Guardian",
    description: "Ensures adherence to security frameworks and standards",
    status: "active",
    tasks_completed: 189,
    success_rate: 99.1,
  },
  {
    id: "dr-agent",
    name: "DR Architect",
    description: "Optimizes disaster recovery and failover strategies",
    status: "active",
    tasks_completed: 87,
    success_rate: 96.8,
  },
];

export const mockSites = [
  {
    id: "site-1",
    name: "us-east-prod",
    platform: "aws",
    region: "us-east-1",
    asset_count: 1243,
    status: "healthy",
    drift_score: 94.5,
    compliance_score: 91.2,
    has_dr_pair: true,
  },
  {
    id: "site-2",
    name: "westeurope-prod",
    platform: "azure",
    region: "West Europe",
    asset_count: 1419,
    status: "warning",
    drift_score: 81.3,
    compliance_score: 87.4,
    has_dr_pair: true,
  },
  {
    id: "site-3",
    name: "us-central-prod",
    platform: "gcp",
    region: "us-central1",
    asset_count: 654,
    status: "healthy",
    drift_score: 88.7,
    compliance_score: 92.8,
    has_dr_pair: true,
  },
  {
    id: "site-7",
    name: "Singapore DC",
    platform: "vsphere",
    region: "ap-southeast-1",
    asset_count: 753,
    status: "healthy",
    drift_score: 79.2,
    compliance_score: 84.1,
    has_dr_pair: false,
  },
];

export const mockRiskSummary = {
  overall_risk_score: 72.5,
  risk_level: "medium",
  critical_issues: 3,
  high_issues: 12,
  medium_issues: 45,
  low_issues: 128,
  risk_factors: [
    {
      category: "Compliance",
      score: 89.5,
      status: "good",
      issues: 2,
      trend: "improving",
    },
    {
      category: "Drift",
      score: 87.5,
      status: "good",
      issues: 4,
      trend: "stable",
    },
    {
      category: "Vulnerabilities",
      score: 65.2,
      status: "warning",
      issues: 8,
      trend: "worsening",
    },
    {
      category: "DR Readiness",
      score: 88.5,
      status: "good",
      issues: 1,
      trend: "improving",
    },
  ],
};

// SBOM Mock Data
export const mockSBOMs = {
  sboms: [
    {
      id: "sbom-1",
      imageId: "image-1",
      format: "spdx",
      version: "2.3",
      generatedAt: "2024-01-16T08:00:00Z",
      packageCount: 156,
      vulnerabilityCount: 8,
    },
    {
      id: "sbom-2",
      imageId: "image-2",
      format: "cyclonedx",
      version: "1.5",
      generatedAt: "2024-01-15T14:00:00Z",
      packageCount: 89,
      vulnerabilityCount: 3,
    },
  ],
  total: 2,
  page: 1,
  pageSize: 100,
};

export const mockSBOMComponents = [
  {
    id: "pkg-1",
    name: "openssl",
    version: "3.0.2",
    type: "library",
    license: "Apache-2.0",
    purl: "pkg:deb/debian/openssl@3.0.2",
    supplier: "Debian Project",
  },
  {
    id: "pkg-2",
    name: "curl",
    version: "7.81.0",
    type: "library",
    license: "MIT",
    purl: "pkg:deb/debian/curl@7.81.0",
    supplier: "Daniel Stenberg",
  },
  {
    id: "pkg-3",
    name: "nginx",
    version: "1.24.0",
    type: "application",
    license: "BSD-2-Clause",
    purl: "pkg:deb/debian/nginx@1.24.0",
    supplier: "Nginx, Inc.",
  },
  {
    id: "pkg-4",
    name: "python3",
    version: "3.11.2",
    type: "application",
    license: "PSF-2.0",
    purl: "pkg:deb/debian/python3@3.11.2",
    supplier: "Python Software Foundation",
  },
  {
    id: "pkg-5",
    name: "systemd",
    version: "249.11",
    type: "library",
    license: "LGPL-2.1",
    purl: "pkg:deb/debian/systemd@249.11",
    supplier: "systemd Developers",
  },
];

export const mockSBOMVulnerabilities = {
  vulnerabilities: [
    {
      id: "vuln-1",
      cveId: "CVE-2024-1234",
      packageId: "pkg-1",
      severity: "critical",
      description: "Buffer overflow vulnerability in OpenSSL",
      fixedVersion: "3.0.3",
      publishedAt: "2024-01-10T00:00:00Z",
      cvss: 9.8,
    },
    {
      id: "vuln-2",
      cveId: "CVE-2024-5678",
      packageId: "pkg-2",
      severity: "high",
      description: "Improper certificate validation in curl",
      fixedVersion: "7.82.0",
      publishedAt: "2024-01-08T00:00:00Z",
      cvss: 7.5,
    },
    {
      id: "vuln-3",
      cveId: "CVE-2024-2345",
      packageId: "pkg-3",
      severity: "medium",
      description: "Information disclosure in nginx",
      fixedVersion: "1.24.1",
      publishedAt: "2024-01-05T00:00:00Z",
      cvss: 5.3,
    },
    {
      id: "vuln-4",
      cveId: "CVE-2024-3456",
      packageId: "pkg-4",
      severity: "low",
      description: "Minor regex DoS in Python",
      fixedVersion: null,
      publishedAt: "2024-01-02T00:00:00Z",
      cvss: 3.1,
    },
  ],
  stats: {
    critical: 1,
    high: 1,
    medium: 1,
    low: 1,
    fixAvailable: 3,
  },
};

export const mockLicenseSummary = {
  totalPackages: 156,
  unlicensedPackages: 3,
  licenses: [
    { name: "MIT", count: 45, percentage: 28.8 },
    { name: "Apache-2.0", count: 38, percentage: 24.4 },
    { name: "BSD-3-Clause", count: 22, percentage: 14.1 },
    { name: "BSD-2-Clause", count: 18, percentage: 11.5 },
    { name: "GPL-2.0", count: 12, percentage: 7.7 },
    { name: "LGPL-2.1", count: 10, percentage: 6.4 },
    { name: "Other", count: 8, percentage: 5.1 },
  ],
};

// InSpec Mock Data
export const mockInSpecProfiles = [
  {
    id: "profile-1",
    name: "linux-baseline",
    version: "4.2.0",
    title: "Linux Security Baseline",
    maintainer: "DevSecOps Team",
    summary: "CIS-based security controls for Linux systems",
    frameworkId: "framework-cis",
    frameworkName: "CIS Benchmarks",
    platforms: ["ubuntu", "debian", "rhel", "centos"],
    controlCount: 142,
    lastUpdated: "2024-01-15T00:00:00Z",
  },
  {
    id: "profile-2",
    name: "aws-foundations",
    version: "3.1.0",
    title: "AWS Foundations Benchmark",
    maintainer: "Cloud Security Team",
    summary: "AWS security best practices and CIS controls",
    frameworkId: "framework-cis",
    frameworkName: "CIS Benchmarks",
    platforms: ["aws"],
    controlCount: 89,
    lastUpdated: "2024-01-10T00:00:00Z",
  },
  {
    id: "profile-3",
    name: "docker-cis",
    version: "2.0.1",
    title: "Docker CIS Benchmark",
    maintainer: "Container Team",
    summary: "CIS Docker Community Edition Benchmark",
    frameworkId: "framework-cis",
    frameworkName: "CIS Benchmarks",
    platforms: ["docker"],
    controlCount: 67,
    lastUpdated: "2024-01-05T00:00:00Z",
  },
];

export const mockInSpecScans = {
  runs: [
    {
      id: "scan-1",
      profileId: "profile-1",
      profileName: "linux-baseline",
      framework: "CIS",
      assetId: "asset-1",
      assetName: "web-server-prod-01",
      status: "completed",
      passRate: 94.5,
      totalTests: 142,
      passedTests: 134,
      failedTests: 8,
      skippedTests: 0,
      duration: 120,
      startedAt: "2024-01-16T10:00:00Z",
      completedAt: "2024-01-16T10:02:00Z",
      createdAt: "2024-01-16T10:00:00Z",
    },
    {
      id: "scan-2",
      profileId: "profile-2",
      profileName: "aws-foundations",
      framework: "CIS",
      assetId: "asset-2",
      assetName: "aws-account-prod",
      status: "completed",
      passRate: 87.6,
      totalTests: 89,
      passedTests: 78,
      failedTests: 11,
      skippedTests: 0,
      duration: 180,
      startedAt: "2024-01-15T14:00:00Z",
      completedAt: "2024-01-15T14:03:00Z",
      createdAt: "2024-01-15T14:00:00Z",
    },
    {
      id: "scan-3",
      profileId: "profile-1",
      profileName: "linux-baseline",
      framework: "CIS",
      assetId: "asset-3",
      assetName: "db-server-prod-01",
      status: "running",
      passRate: 0,
      totalTests: 142,
      passedTests: 0,
      failedTests: 0,
      skippedTests: 0,
      duration: 0,
      startedAt: "2024-01-16T12:00:00Z",
      completedAt: null,
      createdAt: "2024-01-16T12:00:00Z",
    },
  ],
  limit: 10,
  offset: 0,
};

export const mockInSpecSchedules = [
  {
    id: "schedule-1",
    profileId: "profile-1",
    profileName: "linux-baseline",
    assetGroupId: "group-1",
    assetGroupName: "Production Web Servers",
    enabled: true,
    cronExpression: "0 2 * * *",
    nextRunAt: "2024-01-17T02:00:00Z",
    lastRunAt: "2024-01-16T02:00:00Z",
    createdAt: "2024-01-01T00:00:00Z",
  },
  {
    id: "schedule-2",
    profileId: "profile-2",
    profileName: "aws-foundations",
    assetGroupId: "group-2",
    assetGroupName: "AWS Accounts",
    enabled: true,
    cronExpression: "0 0 * * 0",
    nextRunAt: "2024-01-21T00:00:00Z",
    lastRunAt: "2024-01-14T00:00:00Z",
    createdAt: "2024-01-01T00:00:00Z",
  },
  {
    id: "schedule-3",
    profileId: "profile-3",
    profileName: "docker-cis",
    assetGroupId: "group-3",
    assetGroupName: "Container Hosts",
    enabled: false,
    cronExpression: "0 4 * * *",
    nextRunAt: null,
    lastRunAt: "2024-01-10T04:00:00Z",
    createdAt: "2024-01-01T00:00:00Z",
  },
];

export const mockInSpecScanResults = [
  {
    id: "result-1",
    controlId: "CIS-1.1.1",
    title: "Ensure mounting of cramfs filesystems is disabled",
    status: "passed",
    impact: 0.7,
    description: "The cramfs filesystem type is a compressed read-only Linux filesystem.",
    remediation: "Edit /etc/modprobe.d/cramfs.conf and add: install cramfs /bin/true",
    startTime: "2024-01-16T10:00:05Z",
    runTime: 0.23,
  },
  {
    id: "result-2",
    controlId: "CIS-1.1.2",
    title: "Ensure mounting of squashfs filesystems is disabled",
    status: "passed",
    impact: 0.7,
    description: "The squashfs filesystem type is a compressed read-only Linux filesystem.",
    remediation: "Edit /etc/modprobe.d/squashfs.conf and add: install squashfs /bin/true",
    startTime: "2024-01-16T10:00:06Z",
    runTime: 0.18,
  },
  {
    id: "result-3",
    controlId: "CIS-4.1.2",
    title: "Ensure auditing for processes that start prior to auditd is enabled",
    status: "failed",
    impact: 0.9,
    description: "Processes that start prior to auditd may run without being audited.",
    remediation: "Enable audit=1 kernel parameter in bootloader configuration",
    startTime: "2024-01-16T10:01:15Z",
    runTime: 0.45,
  },
  {
    id: "result-4",
    controlId: "CIS-5.2.1",
    title: "Ensure permissions on /etc/ssh/sshd_config are configured",
    status: "passed",
    impact: 0.5,
    description: "The SSH daemon configuration file controls security options.",
    remediation: "Run: chmod 600 /etc/ssh/sshd_config",
    startTime: "2024-01-16T10:01:30Z",
    runTime: 0.12,
  },
];
